@model BlogApp.Data.Dto.Comment.ReportedCommentDto
@using BlogApp.Data.Constants

@{
    var commentDeleteId = "commentDelete" + Model.Id;
    var commentDeleteIdLabel = "commentDeleteLabel" + Model.Id;
    var title = "Delete Comment";
    var message = "Are you sure you want to delete this comment?";
    var confirmUrl = Url.Action(ControllerConstants.DeleteCommentAdmin, ControllerConstants.Comment, new { articleId = Model.ArticleId, commentId = Model.Id });
    var delete = "Delete Comment";
}

@{
    var deleteModal = new BlogApp.Models.ConfirmationModalViewModel
            {
                ModalId = commentDeleteId,
                ModalIdLabel = commentDeleteIdLabel,
                Title = title,
                Message = message,
                ConfirmUrl = confirmUrl!
            };
}

<div class="my-6 border border-gray-200 rounded-xl overflow-hidden shadow-sm bg-white flex flex-col">
    <a asp-action=@ControllerConstants.Article asp-controller=@ControllerConstants.Article asp-route-id=@Model.ArticleId class="px-6 pt-4 pb-3 border-b border-gray-100 bg-gray-50">
        <div class="flex items-center space-x-3">
            @if (!string.IsNullOrEmpty(Model.Article.ImageUrl))
            {
                <div class="flex-shrink-0 w-10 h-10 rounded overflow-hidden bg-gray-200">
                    <img src="@Model.Article.ImageUrl" alt="Article thumbnail" class="w-full h-full object-cover">
                </div>
            }
            <div class="min-w-0">
                <p class="text-xs text-gray-500 font-medium">Article</p>
                <h3 class="text-sm font-semibold text-gray-900 truncate">@Model.Article.Title</h3>
            </div>
        </div>
    </a>

    <div class="px-6 pt-4 flex-1">
        <div class="flex justify-between items-start text-sm">
            <div class="flex space-x-4">
                <div class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 font-bold">
                    @Model.User.Name.Substring(0, 1)@Model.User.Surname.Substring(0, 1)
                </div>

                <div>
                    <p class="font-medium text-gray-900">
                        @Model.User.Name @Model.User.Surname
                        <span class="text-gray-500 font-normal">@@@Model.User.UserName</span>
                    </p>
                    <p class="text-gray-500">
                        @Model.CreatedAt.ToString("MMMM dd, yyyy")
                    </p>
                </div>
            </div>
        </div>

        <div id="comment-content-@Model.Id" class="mt-3 text-gray-700 prose prose-sm max-w-none">
            @Html.Raw(Model.Content)
        </div>
    </div>

    <div class="pb-2 px-6">
        <span class="text-xs text-rose-600 font-medium">
            Reported by @Model.ReportCount Users
        </span>
    </div>

    <div class="px-6 pb-3 mt-auto">
        <div class="flex justify-center items-center border-t border-gray-100 pt-3">
            <button onclick="openModal('@commentDeleteId')"
                    class="text-xs font-medium text-rose-600 hover:text-rose-800 transition-colors duration-200 cursor-pointer">
                @delete
            </button>
        </div>
    </div>

    @await Html.PartialAsync("ConfirmationModal", deleteModal)
</div>